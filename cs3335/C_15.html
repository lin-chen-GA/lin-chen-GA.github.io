<!DOCTYPE html>
<html>
	<head>
		<title>C</title>
		<link rel="stylesheet" href="../css/atelier-sulphurpool-light.css" type="text/css">
		<script src="../js/google-code-prettify/run_prettify.js?autoload=true&amp;lang=css"></script>
		<style>
			div.title {color: navy; font-weight: bold; width: 80%; font-size: 32px; text-align: center; position: relative; margin: auto;}
			div.subtitle {color: navy; font-weight: bold; width: 80%; font-size: 24px; text-align: position: relative; margin: auto;}
			div.block {color: navy; font-weight: bold; width: 80%; border-style: solid; padding: 5px; position: relative; margin: 10px auto; border-radius: 5px;}
			span {color: red; font-weight: bold;}
		</style>
	</head>
	<body>
		<div class = "title">
			Pointer
		</div>

		<div class = "subtitle">2D Array with 1D Pointer</div>
		<div class = "block">
		<pre class = "prettyprint linenums">
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

void display(int *array, int row, int column)
{
	for(int i = 0; i &lt; row; i++)
	{
		for(int j = 0; j &lt; column; j++)
			printf("%5d", array[i*column+j]);
		printf("\n");
	}
}

int * getArray(int row, int column)
{
	int *p;
	p = (int *)malloc(row*column*sizeof(int));

	for(int i = 0; i &lt; row; i++)
		for(int j = 0; j &lt; column; j++)
			p[i*column+j] = i*10+j;
	return p;
}

int main()
{
	int *ptr;
	ptr = getArray(2, 3);

	display(ptr, 2, 3);

	free(ptr);
	
	return 0;
}
		</pre>
		</div>
		<div class = "block">
			<p style = "text-align:center;"><img src = "img/CS3335_24.png" width = "50%"></p>
		</div>
		<div class = "subtitle">Memory Operations</div>
		<div class = "block">
		<pre class = "prettyprint linenums">
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

void display(int *array, int size)
{
	for(int i = 0; i &lt; size; i++)
	{
		printf("%5d", array[i]);
	}

	printf("\n");
}

int * getArray(int size)
{
	int *p;
	p = (int *)malloc(size*sizeof(int));

	return p;
}

int main()
{
	// create an array and assign values
	int *ptr;
	ptr = getArray(10);
	for(int i = 0; i &lt; 10; i++)
		ptr[i] = i;

	// create another array and copy values from ptr to copy
	int *copy;
	copy = getArray(10);
	copy = (int *)realloc(copy, 20*sizeof(int)); // resize array
	memcpy(copy, ptr, sizeof(int)*10);

	// display array
	display(ptr, 10);
	display(copy, 20);

	// free memory
	free(ptr);
	free(copy);
	
	return 0;
}
		</pre>
		</div>
		<div class = "block">
			<li>If 2D array is represented by a 1D pointer, can copy 2D array like copying a 1D array</li>
			<li>memcpy is defined in string.h library</li>
			<li>realloc is defined in stdlib.h library</li>
		</div>
		<div class = "subtitle">2D Array with 2D pointers</div>
		<div class = "block">
		<pre class = "prettyprint linenums">
// pointer to pointer
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

void setArray(int **array, int r, int c)
{
	for(int i = 0; i &lt; r; i++)
		for(int j = 0; j &lt; c; j++)
			array[i][j] = i*10 + j;
}

void dispArray(int **array, int r, int c)
{
	for(int i = 0; i &lt; r; i++)
	{
		for(int j = 0; j &lt; c; j++)
			printf("%10d", *(*(array+i)+j));
		printf("\n");
	}
}

int main()
{
	int r = 3, c = 4;
	int **array;

	// allocate two-dimensional array with a double pointer
	array = (int **)malloc(r*sizeof(int *));

	for(int i = 0; i &lt; r; i++)
		array[i] = (int*)malloc(c*sizeof(int));

	setArray(array, r, c);
	dispArray(array, r, c);

	// free memory
	for(int i = 0; i &lt; r; i++)
		free(array[i]);

	free(array);
	
	return 0;
}
		</pre>
		</div>
		<div class = "block">
			<p style = "text-align:center;"><img src = "img/CS3335_25.png" width = "30%"></p>
		</div>
		<div class = "block">
			<li>Copy a 2D array represented by a 2D pointer, need to copy row by row</li>
			<li>Copy the consecutive memory from the memory address of the first element may generate errors, since the rows may not allocated consecutively</li>
		</div>
		<div class = "subtitle">Common Errors</div>
		<div class = "block">
		<pre class = "prettyprint linenums">
// work
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main()
{
	int array[10];
	for(int i = 0; i &lt; 10; i++)
		array[i] = i;

	int *ptr;
	ptr = array;
	for(int i = 0; i &lt; 10; i++)
		printf("%4d", ptr[i]);

	return 0;
}
		</pre>
		</div>
		<div class = "block">
		<pre class = "prettyprint linenums">
// not work
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int * getArray()
{
	int array[10];
	for(int i = 0; i &lt; 10; i++)
		array[i] = i;

	int *p;
	p = array;

	return p;
}

int main()
{
	int *ptr = getArray();
	for(int i = 0; i &lt; 10; i++)
		printf("%4d", ptr[i]);
	printf("\n");

	return 0;
}
		</pre>
		</div>
		<div class = "block">
			<p style = "text-align:center;"><img src = "img/CS3335_27.png" width = "60%"></p>
		</div>
		<div class = "subtitle"><span>Exercise 1</span></div>
		<div class = "block">
			<li>Write a C program, read the row number and column number from the keyboard to create a 2D array. Each element in the array is a random number between 1 to 10</li>
			<li>Print out the 2D array</li>
			<li>Sort each row of the 2D array, leave the original copy untouched</li>
			<li>Print out the original copy and the sorted copy</li>
		</div>
		<div class = "subtitle"><a href = "C_15_S.html">Solution</a></div>
	</body>
</html>
